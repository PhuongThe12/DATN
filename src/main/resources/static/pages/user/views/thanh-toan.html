<style>


    .cart-selected-list {
        transition: 0.3s ease;
    }

    .cart-click {
        cursor: pointer;
        border-bottom: 1px solid #dedede;
        border-top: 1px solid #dedede;
        padding: 18px 0px 10px 0px;
        margin-bottom: 10px;
    }

    .rotate-icon {
        transform: rotate(180deg); /* Xoay 180 độ */
        transition: 0.3s ease-in-out;
    }

    .coupon-item-left::before {
        position: absolute;
        content: '';
        width: 20px;
        height: 20px;
        right: -50px;
        top: -21px;
        border-radius: 50%;
        background: #e0e0e0;

    }

    .coupon-item-left::after {
        position: absolute;
        content: '';
        border-radius: 50%;
        width: 20px;
        height: 20px;
        right: -50px;
        bottom: -20px;
        background: #e0e0e0;
    }

    .coupon-item-left {
        position: relative;
    }

    .coupon-outer {
        background: white;
        padding: 10px;
    }

    .modal-coupon {
        background: #e0e0e0;
    }
</style>
<div class="container pt-5">
    <div class="row">
        <div class="col-md-8">
            <p class="fw-bold">Thông Tin Khách Hàng</p>
            <div>
                <form action="">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label for="nhanVienTen" class="form-label">Họ và tên</label>
                                <input type="text" class="form-control" ng-model="diaChiNhanHang.hoTen">

                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label for="nhanVienTen" class="form-label">Số điện thoại</label>
                                <input type="text" class="form-control" ng-model="diaChiNhanHang.soDienThoaiNhan">

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label for="nhanVienTen" class="form-label">Email </label>
                                <input type="text" class="form-control" ng-model="khachHang.email">

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Tỉnh / Thành Phố </label>
                                <select class="form-select" aria-label="Default select example"
                                        name="provinces" ng-model="diaChiNhanHang.provinces"
                                        ng-options="province.ten for province in provinces"
                                        ng-change="changeProvince()">
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Quận / Huyện </label>
                                <select class="form-select" aria-label="Default select example"
                                        name="districts" ng-model="diaChiNhanHang.districts"
                                        ng-options="district.ten for district in districts"
                                        ng-change="changeDistrict()">
                                </select>

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label class="form-label">Xã / Phường </label>
                                <select class="form-select" aria-label="Default select example"
                                        name="wards" ng-model="diaChiNhanHang.wards"
                                        ng-options="ward.ten for ward in wards">
                                </select>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="mb-3">
                                <label for="exampleFormControlTextarea1" class="form-label">Địa chỉ chi tiết</label>
                                <textarea ng-model="diaChiNhanHang.diaChiNhan" class="form-control"
                                          id="exampleFormControlTextarea1" rows="3"></textarea>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-custom w-100 mb-5" type="button" ng-click="thanhToan()">Thanh Toán</button>
                </form>
            </div>

        </div>
        <div class="col-md-4">
            <div>
                <div ng-click="toggleHeight()" class="cart-click d-flex align-items-center justify-content-between">
                    <h5 class="font-size-14-ncl">Giỏ hàng ( {{listBienTheGiayLocalStorage.length}} )</h5> <i
                        style="margin-bottom: 8px;" class="fas fa-caret-down " id="icon-drop-down"></i>
                </div>
                <div class="cart-selected-list" id="cart">
                    <div ng-repeat="bienTheGiay in listBienTheGiayLocalStorage">
                        <p class="font-size-14-ncl fw-bold text-dark mb-2 text-wrap-none">
                            {{bienTheGiay.giayResponse.ten}}</p>
                        <div class="d-flex mb-3">
                            <div>
                                <a href="#/detail/{{bienTheGiay.id}}">
                                    <img class="rounded" width="70px"
                                         src="https://secure-images.nike.com/is/image/DotCom/FB8900_100?align=0,1&cropN=0,0,0,0&resMode=sharp&bgc=f5f5f5&wid=150&fmt=jpg"
                                         alt="">
                                </a>
                            </div>
                            <div class="w-75 ps-3">

                                <div class="d-flex align-items-center justify-content-between">
                                    <p class="font-size-14-ncl text-secondary mb-1">Kích cỡ :
                                        {{bienTheGiay.kichThuoc.ten}} / Màu Sắc : {{bienTheGiay.mauSac.ten}}</p>

                                </div>
                                <div class=" d-flex">
                                    <p class="font-size-12-ncl text-dark mb-1">Số lượng : {{bienTheGiay.soLuongMua}}</p>
                                    <div ng-repeat="error in data">
                                        <div ng-if="getErrorId(error) === bienTheGiay.id">
                                            <!-- Hiển thị message lỗi dưới sản phẩm -->
                                            {{ error.split(':')[1] }}
                                        </div>
                                    </div>
                                </div>
                                <div class=" d-flex  mb-3">
                                    <p class="font-size-13-ncl fw-bold text-dark mb-1"><span
                                            ng-show="bienTheGiay.khuyenMai">
                                            <del>{{bienTheGiay.giaBan  | number:0 }}</del>
                                        <span class="position-relative">
                                            {{bienTheGiay.giaSauKhuyenMai| number:0 }}
                                        <span class="position-absolute top-0 start-100 translate-middle badge bg-danger"
                                              style="transform: translate(0,-50%)!important; padding: 5px;">
                                            -{{bienTheGiay.khuyenMai}}%
                                        </span>
                                        </span>
                                        </span>
                                        <span ng-show="!bienTheGiay.khuyenMai">
                                            {{ bienTheGiay.giaBan | number:0}}
                                        </span></p>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
                <div>
                    <p class="font-size-14-ncl border-bottom-1 py-2 fw-bold">Thông Tin Thanh Toán</p>

                    <div class="d-flex align-items-center justify-content-between  border-bottom-1">
                        <p class=" font-size-14-ncl py-1">Tổng tiền</p>
                        <p class="fw-bold font-size-14-ncl">{{tongTien | number}} ₫</p>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <p class=" font-size-14-ncl py-1">Hạng Khách Hàng</p>
                        <p class="fw-bold font-size-14-ncl">
                            <span ng-show="tongKhuyenMaiHoaDon === 0">-</span>
                            <span ng-show="tongKhuyenMaiHoaDon !== 0">-{{tongKhuyenMaiHoaDon | number}} ₫</span>
                            <span ng-show="tongKhuyenMaiHoaDon !== 0">(-{{khachHang.hangKhachHang.uuDai}}% )</span></p>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <p class=" font-size-14-ncl py-1">Chương trình giảm giá</p>
                        <p class="fw-bold font-size-14-ncl">
                            <span ng-show="tongKhuyenMaiTheoDot !== 0">{{tongKhuyenMaiTheoDot | number}} ₫</span>
                            <span ng-show="tongKhuyenMaiTheoDot === 0">-</span>
                            <span class="text-danger" ng-show="tongKhuyenMaiTheoDot !== 0">( -{{khuyenMaiDot}}% )</span>
                    </div>

                    <div class="d-flex align-items-center justify-content-between">
                        <p class=" font-size-14-ncl py-1">Voucher</p>
                        <p class="fw-bold font-size-14-ncl"> <span ng-show="phieuGiamGiaChoosed">
                            {{phieuGiamGiaChoosed.maGiamGia}} <span
                                class="font-size-14-ncl text-danger">-{{(tongTien *
                            phieuGiamGiaChoosed.phanTramGiam)/100}}</span>
                        </span>
                            <button class="btn btn-outline-dark" data-bs-toggle="modal"
                                    data-bs-target="#phieuGiamGiaModal" ng-click="getPhieuGiamGia()"><i
                                    class="fas fa-exchange-alt"></i></button>
                        </p>
                    </div>
                    <div class="d-flex align-items-center justify-content-between">
                        <p class=" font-size-14-ncl py-1">Phí ship</p>
                        <p class="fw-bold font-size-14-ncl">{{feeShippingPerOne | number : 0}} ₫</p>
                    </div>
                    <div class="d-flex align-items-center justify-content-between">
                        <p class=" font-size-14-ncl py-1">Tổng thanh toán</p>
                        <p class="fw-bold font-size-14-ncl">{{tongThanhToan | number}} ₫</p>
                    </div>

                    <div class="mb-4">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" ng-model="phuongThucThanhToan" value="1">
                            <label class="form-check-label" for="flexRadioDefault1">
                                Khi nhận hàng
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" ng-model="phuongThucThanhToan" value="2"
                                   checked>
                            <label class="form-check-label" for="flexRadioDefault2">
                                Banking
                            </label>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


<p id="soldout" data-bs-toggle="modal" data-bs-target="#staticBackdrop"></p>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" tabindex="-1" aria-labelledby="staticBackdrop" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered  modal-lg">
        <div class="modal-content">

            <div class="modal-body">
                <h5 class="modal-title mb-1" id="staticBackdropLabel">Số lượng giày trong kho không đủ vui lòng kiểm tra
                    lại</h5>
                <p class="font-size-12-ncl mb-3">Tải lại trang để cập nhật mới nhất về trạng thái sản phẩm</p>
                <div ng-show="productsSoldOutQuantity.length > 0">
                    <h5>Sản phẩm hết hàng</h5>
                    <div class="d-flex mb-3" ng-repeat="bienTheGiay in productsSoldOutQuantity">
                        <div>
                            <a href="#/detail/{{bienTheGiay.id}}">
                                <img class="rounded" width="100%"
                                     src="https://secure-images.nike.com/is/image/DotCom/FB8900_100?align=0,1&cropN=0,0,0,0&resMode=sharp&bgc=f5f5f5&wid=150&fmt=jpg"
                                     alt="">
                            </a>
                        </div>
                        <div class="w-75 ps-3">
                            <div class="d-flex align-items-center">
                                <p class="font-size-14-ncl fw-bold text-dark mb-2 text-wrap-none">
                                    {{bienTheGiay.giayResponse.ten}}</p>
                            </div>
                            <div class="d-flex align-items-center justify-content-between">
                                <p class="font-size-14-ncl text-secondary">Kích cỡ : {{bienTheGiay.kichThuoc.ten}} / Màu
                                    Sắc : {{bienTheGiay.mauSac.ten}}</p>
                                <p class="font-size-16-ncl fw-bold text-dark">{{bienTheGiay.giaBan | number}} ₫</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div ng-show="productsLessQuantity.length > 0">
                    <h5>Sản phẩm vượt quá số lượng</h5>
                    <div class="d-flex mb-3" ng-repeat="bienTheGiay in productsLessQuantity">
                        <div>
                            <a href="#/detail/{{bienTheGiay.id}}">
                                <img class="rounded" width="100%"
                                     src="https://secure-images.nike.com/is/image/DotCom/FB8900_100?align=0,1&cropN=0,0,0,0&resMode=sharp&bgc=f5f5f5&wid=150&fmt=jpg"
                                     alt="">
                            </a>
                        </div>
                        <div class="w-75 ps-3">
                            <div class="d-flex align-items-center">
                                <p class="font-size-14-ncl fw-bold text-dark mb-2 text-wrap-none">
                                    {{bienTheGiay.giayResponse.ten}}</p>
                            </div>
                            <div class="d-flex align-items-center justify-content-between">
                                <p class="font-size-14-ncl text-secondary">Kích cỡ : {{bienTheGiay.kichThuoc.ten}} / Màu
                                    Sắc : {{bienTheGiay.mauSac.ten}}</p>
                                <p class="font-size-16-ncl fw-bold text-dark">{{bienTheGiay.giaBan | number}} ₫</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Modal -->
<div class="modal fade" id="phieuGiamGiaModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-body modal-coupon">
                <div>
                    <h2 class="font-size-16-ncl">Danh Sách Phiếu Giảm Giá</h2>
                    <div >
                        <div class="d-flex coupon-outer align-items-center justify-content-between mb-1"
                             ng-repeat="pgg in phieuGiamGiaList">

                            <div class="coupon-item-left">
                                <img width="80px" class="rounded"
                                     src="https://play-lh.googleusercontent.com/FwtFo7JjEQ7UE-857BU1flMZQUoA_SFIfdLN3NAiqJzQBrNi3FBEdWnrW1c3pOwekJ9z"
                                     alt="">
                            </div>
                            <div class="ps-3 ms-2 coupon-item-right" style="    border-left: 1px dashed #ccc;">
                                <p class="font-size-16-ncl fw-bold m-0">Giảm {{pgg.phanTramGiam}}%</p>
                                <p class="font-size-12-ncl m-0 fw-bold">Đơn Tối Thiểu {{pgg.giaTriDonToiThieu |
                                    number:0}} đ ( Giảm tối đa {{pgg.giaTriGiamToiDa | number:0}} đ )</p>
                                <p class="font-size-14-ncl m-0">Mã : {{pgg.maGiamGia}}</p>
                                <p class="font-size-14-ncl m-0">Số Lượng Còn Lại: {{pgg.soLuongPhieu}}</p>
                            </div>
                            <div>
                                <button class="btn btn-dark" ng-click="addPhieuGiamGia(pgg)"><i
                                        class="fas font-size-12-ncl fa-plus"></i></button>
                            </div>
                        </div>
                    </div>

                    <div ng-show="phieuGiamGiaList.length === 0">
                        <h2 style="text-align: center;">Danh sách trống</h2>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>